# WhatsApp RTMPS Bot

هذا المشروع يقدم بوت واتساب قادر على بث ملفات الفيديو إلى خوادم RTMPS (مثل YouTube Live, Facebook Live) باستخدام ميزة الأجهزة المتصلة في واتساب (WhatsApp Web) و FFmpeg.

## المتطلبات الأساسية

- Node.js (الإصدار 16 أو أحدث)
- npm (مدير حزم Node.js)
- FFmpeg (يجب أن يكون مثبتًا على النظام الذي سيتم تشغيل البوت عليه)
- حساب واتساب لاستخدامه مع WhatsApp Web.

## الميزات

- الاتصال بـ WhatsApp Web.
- استقبال أوامر البث مع رابط RTMPS ومفتاح البث ومسار الفيديو وعدد مرات التكرار.
- بث الفيديو باستخدام FFmpeg.
- إرسال تقارير حالة البث إلى المستخدم.

## الإعداد والتشغيل المحلي

1.  **استنساخ المستودع:**

    ```bash
    git clone <YOUR_REPOSITORY_URL>
    cd whatsapp-rtmps-bot
    ```

2.  **تثبيت التبعيات:**

    ```bash
    npm install
    ```

3.  **تثبيت FFmpeg:**

    تأكد من تثبيت FFmpeg على نظامك. على أنظمة Ubuntu/Debian، يمكنك تثبيته كالتالي:

    ```bash
    sudo apt update
    sudo apt install ffmpeg
    ```

4.  **تشغيل البوت:**

    ```bash
    node index.js
    ```

    عند التشغيل لأول مرة، سيظهر رمز QR في الطرفية. امسح هذا الرمز باستخدام هاتفك من خلال "الأجهزة المتصلة" في واتساب.

## الأوامر المدعومة

-   `!ping`: للتحقق من أن البوت يعمل. سيرد بـ `pong`.
-   `!stream <RTMPS_URL> <STREAM_KEY> <VIDEO_PATH_OR_URL> [REPEAT_COUNT]`: لبدء بث فيديو.
    -   `<RTMPS_URL>`: رابط خادم RTMPS (مثال: `rtmp://a.rtmp.youtube.com/live2`).
    -   `<STREAM_KEY>`: مفتاح البث الخاص بك.
    -   `<VIDEO_PATH_OR_URL>`: المسار المحلي لملف الفيديو أو رابط URL لتحميله (حاليًا يدعم المسارات المحلية فقط).
    -   `[REPEAT_COUNT]`: (اختياري) عدد مرات تكرار البث. الافتراضي هو 1.
    
    مثال:
    `!stream rtmp://a.rtmp.youtube.com/live2 your_stream_key /home/user/videos/my_video.mp4 3`

-   `!stop`: (غير مطبق بالكامل حاليًا) لإيقاف أي بث نشط.

## GitHub Actions

تم إعداد GitHub Action لتشغيل البوت تلقائيًا عند كل عملية `push` إلى المستودع. ومع ذلك، يجب ملاحظة أن تشغيل بوت واتساب يتطلب مسح رمز QR يدويًا للحفاظ على الجلسة، وهو أمر لا يمكن أتمتته بسهولة في بيئة GitHub Actions الافتراضية.

**ملاحظات هامة حول GitHub Actions:**

-   **مصادقة WhatsApp Web:** لا يمكن لـ GitHub Actions مسح رمز QR تلقائيًا. ستحتاج إلى حل لتخزين واستعادة جلسة WhatsApp Web بشكل دائم، أو استخدام بيئة تشغيل ذاتية الاستضافة (self-hosted runner) حيث يمكنك مسح رمز QR يدويًا مرة واحدة.
-   **استمرارية الجلسة:** `whatsapp-web.js` يستخدم `LocalAuth` لتخزين الجلسة محليًا. في بيئة GitHub Actions، يتم إنشاء بيئة جديدة في كل مرة، مما يعني فقدان الجلسة. لحل هذه المشكلة، ستحتاج إلى: 
    -   تخزين مجلد الجلسة (`.wwebjs_auth`) كـ artifact أو في تخزين سحابي.
    -   استعادته قبل تشغيل البوت في كل مرة.
    -   أو استخدام طريقة مصادقة أخرى تدعم البيئات غير المستمرة.

## تحسينات مستقبلية محتملة

-   دعم تحميل ملفات الفيديو من الروابط (URLs).
-   إدارة أفضل لجلسات WhatsApp Web في بيئات غير مستمرة.
-   واجهة مستخدم (UI) بسيطة لإدارة البث.
-   إضافة ميزات جدولة البث.
-   تحسين معالجة الأخطاء وإرسال إشعارات أكثر تفصيلاً.

## المساهمة

نرحب بالمساهمات! يرجى فتح `issue` أو إرسال `pull request`.

## الترخيص

هذا المشروع مرخص تحت رخصة MIT. انظر ملف `LICENSE` لمزيد من التفاصيل.
